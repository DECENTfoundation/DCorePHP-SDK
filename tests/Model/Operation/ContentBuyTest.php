<?php

use DCorePHP\Model\Asset\AssetAmount;
use DCorePHP\Model\Operation\RequestToBuy;
use DCorePHP\Model\ChainObject;
use DCorePHP\Model\PubKey;
use PHPUnit\Framework\TestCase;

class ContentBuyTest extends TestCase
{

    public function testToBytes()
    {

        $operation = new RequestToBuy();
        $operation
            ->setUri('ipfs:QmabU7WNHZwcojgJrCRwKhsJvfinLT9xffnKMFsrcCGGFP')
            ->setConsumer(new ChainObject('1.2.30'))
            ->setPrice((new AssetAmount())->setAssetId(new ChainObject('1.3.0'))->setAmount(10000000))
            ->setRegionCodeFrom(1)
            ->setElGamalPublicKey((new PubKey())->setPubKey('9108409595926410618584909688806123815350070889187120060090262698305971998526501009804554058758289676257609340949615914583138841456997698133991004991473670'));

        $this->assertEquals(
            '1500000000000000000033697066733a516d61625537574e485a77636f6a674a724352774b68734a7666696e4c54397866666e4b4d4673726343474746501e809698000000000000010000009b01393130383430393539353932363431303631383538343930393638383830363132333831353335303037303838393138373132303036303039303236323639383330353937313939383532363530313030393830343535343035383735383238393637363235373630393334303934393631353931343538333133383834313435363939373639383133333939313030343939313437333637302e',
            $operation->toBytes()
        );
    }

}
